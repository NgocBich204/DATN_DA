<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Modun ƒê·ªÅ Xu·∫•t Chi·∫øn L∆∞·ª£c Marketing</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide-react@latest/dist/umd/lucide.min.js"></script>
    <style>
      /* S·ª≠ d·ª•ng font Inter */
      @import url("https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap");
      body {
        font-family: "Inter", sans-serif;
        background-color: #f3f4f6; /* bg-gray-100 */
      }
      /* ·∫®n/hi·ªán c√°c b∆∞·ªõc */
      .step-section {
        display: none;
      }
      .step-section.active {
        display: block;
      }
      /* T√πy ch·ªânh thanh cu·ªôn */
      ::-webkit-scrollbar {
        width: 6px;
      }
      ::-webkit-scrollbar-thumb {
        background-color: #9ca3af; /* gray-400 */
        border-radius: 3px;
      }
      /* CSS cho modal */
      .modal {
        display: none; /* ·∫®n m·∫∑c ƒë·ªãnh */
        position: fixed;
        z-index: 50;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        overflow: auto;
        background-color: rgba(0, 0, 0, 0.5); /* N·ªÅn m·ªù */
        justify-content: center;
        align-items: center;
      }
      .modal.flex {
        display: flex;
      }
      .modal-content {
        background-color: white;
        margin: auto;
        padding: 24px; /* p-6 */
        border-radius: 8px; /* rounded-lg */
        box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1),
          0 4px 6px -2px rgba(0, 0, 0, 0.05); /* shadow-xl */
        max-width: 90%;
      }
      /* CSS cho thanh ti·∫øn tr√¨nh */
      .stepper-item {
        @apply flex items-center text-gray-400 relative;
      }
      .stepper-item .step-counter {
        @apply w-10 h-10 flex items-center justify-center rounded-full border-2 border-gray-300 bg-white text-gray-400 font-semibold;
      }
      .stepper-item .step-name {
        @apply ml-3 text-sm font-medium;
      }
      /* ƒê√£ c·∫≠p nh·∫≠t cho 6 b∆∞·ªõc */
      .stepper-item:not(:last-child)::after {
        content: "";
        @apply absolute w-full h-0.5 bg-gray-300 top-5 left-0 -translate-x-1/2 ml-[5rem]; /* ƒêi·ªÅu ch·ªânh v·ªã tr√≠ */
        width: calc(100% - 4rem); /* 100% - icon_width - margins */
      }
      /* Tr·∫°ng th√°i Active */
      .stepper-item.active .step-counter {
        @apply border-blue-600 bg-blue-600 text-white;
      }
      .stepper-item.active .step-name {
        @apply text-blue-600;
      }
      /* Tr·∫°ng th√°i Completed */
      .stepper-item.completed .step-counter {
        @apply border-blue-600 bg-white text-blue-600;
      }
      .stepper-item.completed .step-name {
        @apply text-gray-600;
      }
      .stepper-item.completed:not(:last-child)::after {
        @apply bg-blue-600;
      }
    </style>
  </head>
  <body class="bg-gray-100">
    <div id="app" class="container mx-auto p-4 md:p-8">
      <header
        class="mb-8 p-6 bg-white rounded-lg shadow-md flex flex-col md:flex-row justify-between items-center"
      >
        <div>
          <h1 class="text-3xl font-bold text-gray-800">
            Modun ƒê·ªÅ Xu·∫•t Chi·∫øn L∆∞·ª£c
          </h1>
          <p class="text-gray-500">
            V·∫≠n h√†nh chi·∫øn l∆∞·ª£c marketing c√° nh√¢n h√≥a ƒëa k√™nh
          </p>
        </div>
        <nav class="flex space-x-2 mt-4 md:mt-0">
          <button
            id="navCreateNew"
            class="bg-blue-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-blue-700 transition-colors shadow"
          >
            T·∫°o Chi·∫øn D·ªãch M·ªõi
          </button>
          <button
            id="navDashboard"
            class="bg-gray-200 text-gray-700 px-4 py-2 rounded-lg font-medium hover:bg-gray-300 transition-colors"
          >
            Xem Dashboard (0)
          </button>
        </nav>
      </header>

      <main>
        <div id="wizardView">
          <div class="mb-8 p-4 bg-white rounded-lg shadow-sm overflow-x-auto">
            <ol class="flex items-center w-full min-w-[850px]">
              <li id="stepper-1" class="stepper-item active w-1/6">
                <span class="step-counter">1</span>
                <span class="step-name">Ch·ªçn N·ªÅn T·∫£ng</span>
              </li>
              <li id="stepper-2" class="stepper-item w-1/6">
                <span class="step-counter">2</span>
                <span class="step-name">Ch·ªçn M·ª•c Ti√™u</span>
              </li>
              <li id="stepper-3" class="stepper-item w-1/6">
                <span class="step-counter">3</span>
                <span class="step-name">Ch·ªçn Ph√¢n Kh√∫c</span>
              </li>
              <li id="stepper-4" class="stepper-item w-1/6">
                <span class="step-counter">4</span>
                <span class="step-name">Ch·ªçn Chi·∫øn Thu·∫≠t</span>
              </li>
              <li id="stepper-5" class="stepper-item w-1/6">
                <span class="step-counter">5</span>
                <span class="step-name">Thi·∫øt K·∫ø</span>
              </li>
              <li id="stepper-6" class="stepper-item w-1/6">
                <span class="step-counter">6</span>
                <span class="step-name">Ho√†n T·∫•t</span>
              </li>
            </ol>
          </div>

          <section
            id="step-1"
            class="step-section active bg-white p-6 rounded-lg shadow-lg"
          >
            <h2 class="text-2xl font-semibold mb-1">
              B∆∞·ªõc 1: Ch·ªçn N·ªÅn T·∫£ng Kinh Doanh Ch√≠nh
            </h2>
            <p class="text-gray-600 mb-6">
              Kh√°ch h√†ng c·ªßa b·∫°n ch·ªß y·∫øu ƒëang ·ªü ƒë√¢u? ƒêi·ªÅu n√†y s·∫Ω gi√∫p h·ªá th·ªëng
              ƒë·ªÅ xu·∫•t k·ªãch b·∫£n ph√π h·ª£p.
            </p>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
              <div
                class="border border-gray-200 rounded-lg p-6 shadow-sm hover:shadow-xl hover:border-blue-500 transition-all cursor-pointer"
                onclick="app.selectPlatform('owned')"
              >
                <span class="text-4xl">üåê</span>
                <h3 class="text-xl font-semibold mt-3 mb-2 text-gray-800">
                  K√™nh S·ªü H·ªØu (Owned)
                </h3>
                <p class="text-gray-500 text-sm">
                  Doanh nghi·ªáp c·ªßa t√¥i c√≥ Website, App, CRM ri√™ng v√† mu·ªën c√°
                  nh√¢n h√≥a tr·∫£i nghi·ªám tr√™n c√°c k√™nh n√†y (Email, Zalo, Web
                  Popup...).
                </p>
              </div>
              <div
                class="border border-gray-200 rounded-lg p-6 shadow-sm hover:shadow-xl hover:border-blue-500 transition-all cursor-pointer"
                onclick="app.selectPlatform('marketplace')"
              >
                <span class="text-4xl">üõçÔ∏è</span>
                <h3 class="text-xl font-semibold mt-3 mb-2 text-gray-800">
                  K√™nh S√†n TMƒêT (Marketplace)
                </h3>
                <p class="text-gray-500 text-sm">
                  Doanh nghi·ªáp c·ªßa t√¥i kinh doanh ch·ªß y·∫øu tr√™n c√°c s√†n nh∆∞
                  Shopee, Lazada, Tiki... v√† mu·ªën t·∫≠n d·ª•ng c√°c c√¥ng c·ª• c·ªßa s√†n
                  (Ads, Voucher, Livestream).
                </p>
              </div>
            </div>
          </section>

          <section
            id="step-2"
            class="step-section bg-white p-6 rounded-lg shadow-lg"
          >
            <button
              class="text-sm text-blue-600 hover:underline mb-4"
              onclick="app.goBack(1)"
            >
              &larr; Quay l·∫°i ch·ªçn N·ªÅn T·∫£ng
            </button>
            <h2 id="step-2-title" class="text-2xl font-semibold mb-1">
              B∆∞·ªõc 2: X√°c ƒë·ªãnh M·ª•c ti√™u Chi·∫øn l∆∞·ª£c (The "Why")
            </h2>
            <p id="step-2-desc" class="text-gray-600 mb-6">
              Ch·ªçn m·ª•c ti√™u kinh doanh c·ªët l√µi ƒë·ªÉ h·ªá th·ªëng ƒë·ªÅ xu·∫•t ph√¢n kh√∫c
              kh√°ch h√†ng ph√π h·ª£p.
            </p>

            <div id="goal-dashboard-container"></div>
          </section>

          <section
            id="step-3"
            class="step-section bg-white p-6 rounded-lg shadow-lg"
          >
            <button
              class="text-sm text-blue-600 hover:underline mb-4"
              onclick="app.goBack(2)"
            >
              &larr; Quay l·∫°i ch·ªçn M·ª•c ti√™u
            </button>
            <h2 class="text-2xl font-semibold mb-1">
              B∆∞·ªõc 3: ƒê·ªÅ xu·∫•t Ph√¢n kh√∫c ƒê·ªëi t∆∞·ª£ng (The "Who")
            </h2>
            <p class="text-gray-600 mb-6">
              D·ª±a tr√™n m·ª•c ti√™u
              <strong id="selected-goal-text" class="text-blue-700"></strong>,
              h·ªá th·ªëng ƒë·ªÅ xu·∫•t c√°c ph√¢n kh√∫c sau:
            </p>
            <div id="segment-cards-container" class="space-y-6"></div>
          </section>

          <section
            id="step-4"
            class="step-section bg-white p-6 rounded-lg shadow-lg"
          >
            <button
              id="step-4-back-button"
              class="text-sm text-blue-600 hover:underline mb-4"
              onclick="app.goBack(3)"
            >
              &larr; Quay l·∫°i ch·ªçn Ph√¢n kh√∫c
            </button>

            <h2 class="text-2xl font-semibold mb-1">
              B∆∞·ªõc 4: ƒê·ªÅ xu·∫•t K·ªãch b·∫£n & Chi·∫øn thu·∫≠t (The "How")
            </h2>
            <p class="text-gray-600 mb-6">
              Ch·ªçn m·ªôt k·ªãch b·∫£n/chi·∫øn thu·∫≠t cho
              <strong id="selected-segment-text" class="text-blue-700"></strong
              >.
            </p>
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8" id="step-4-grid">
              <div
                id="owned-channels"
                class="bg-gray-50 p-5 rounded-lg border border-gray-200 transition-all duration-300"
              >
                <h3 class="text-xl font-semibold mb-4 text-gray-800">
                  A. K√™nh s·ªü h·ªØu (Owned Channels)
                </h3>
                <p class="text-sm text-gray-500 mb-4">
                  T·∫≠p trung v√†o c√° nh√¢n h√≥a s√¢u v√† t·ª± ƒë·ªông h√≥a tr√™n website,
                  app, CRM.
                </p>
                <div id="owned-tactics-list" class="space-y-3"></div>
              </div>

              <div
                id="marketplace-channels"
                class="bg-gray-50 p-5 rounded-lg border border-gray-200 transition-all duration-300"
              >
                <h3 class="text-xl font-semibold mb-4 text-gray-800">
                  B. K√™nh S√†n TMƒêT (Marketplace)
                </h3>
                <p class="text-sm text-gray-500 mb-4">
                  T·∫≠n d·ª•ng c√°c c√¥ng c·ª• c√≥ s·∫µn c·ªßa Shopee, Lazada, v.v.
                </p>
                <div id="marketplace-tactics-list" class="space-y-3"></div>
              </div>
            </div>
          </section>

          <section
            id="step-5"
            class="step-section bg-white p-6 rounded-lg shadow-lg"
          >
            <button
              class="text-sm text-blue-600 hover:underline mb-4"
              onclick="app.goBack(4)"
            >
              &larr; Quay l·∫°i ch·ªçn Chi·∫øn thu·∫≠t
            </button>
            <h2 class="text-2xl font-semibold mb-1">
              B∆∞·ªõc 5: Tr√¨nh D·ª±ng Chi·∫øn D·ªãch (Campaign Builder)
            </h2>
            <p class="text-gray-600 mb-6">
              C·∫•u h√¨nh chi ti·∫øt cho chi·∫øn d·ªãch c·ªßa b·∫°n.
            </p>

            <form id="campaign-builder-form" class="space-y-6">
              <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                  <label
                    for="campaign-name"
                    class="block text-sm font-medium text-gray-700"
                    >T√™n Chi·∫øn D·ªãch</label
                  >
                  <input
                    type="text"
                    id="campaign-name"
                    class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"
                    required
                  />
                </div>
                <div>
                  <label
                    for="campaign-segment"
                    class="block text-sm font-medium text-gray-700"
                    >G·ª≠i ƒê·∫øn (Ph√¢n Kh√∫c / Logic)</label
                  >
                  <input
                    type="text"
                    id="campaign-segment"
                    class="mt-1 block w-full rounded-md border-gray-300 bg-gray-100"
                    readonly
                  />
                </div>
              </div>

              <div
                id="dynamic-tactic-config"
                class="p-4 bg-blue-50 border border-blue-200 rounded-lg"
              >
                <h4
                  id="dynamic-tactic-title"
                  class="text-lg font-semibold text-blue-800 mb-4"
                >
                  C·∫•u h√¨nh chi ti·∫øt:
                </h4>
                <div id="dynamic-tactic-form-fields" class="space-y-4"></div>
              </div>

              <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                  <label
                    for="campaign-budget"
                    class="block text-sm font-medium text-gray-700"
                    >T·ªïng Ng√¢n S√°ch (VNƒê)</label
                  >
                  <input
                    type="number"
                    id="campaign-budget"
                    class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"
                    placeholder="0"
                  />
                </div>
                <div>
                  <label
                    for="campaign-kpi"
                    class="block text-sm font-medium text-gray-700"
                    >M·ª•c Ti√™u KPI (V√≠ d·ª•: 50 ƒë∆°n h√†ng)</label
                  >
                  <input
                    type="text"
                    id="campaign-kpi"
                    class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"
                  />
                </div>
              </div>

              <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                  <label
                    for="campaign-start-date"
                    class="block text-sm font-medium text-gray-700"
                    >Ng√†y B·∫Øt ƒê·∫ßu</label
                  >
                  <input
                    type="date"
                    id="campaign-start-date"
                    class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"
                    required
                  />
                </div>
                <div>
                  <label
                    for="campaign-end-date"
                    class="block text-sm font-medium text-gray-700"
                    >Ng√†y K·∫øt Th√∫c</label
                  >
                  <input
                    type="date"
                    id="campaign-end-date"
                    class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"
                    required
                  />
                </div>
              </div>

              <div>
                <label
                  for="campaign-notes"
                  class="block text-sm font-medium text-gray-700"
                  >Ghi Ch√∫ N·ªôi B·ªô</label
                >
                <textarea
                  id="campaign-notes"
                  rows="3"
                  class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"
                ></textarea>
              </div>

              <div
                class="flex justify-end space-x-4 pt-4 border-t border-gray-200"
              >
                <button
                  type="button"
                  onclick="app.showDemoModal()"
                  class="bg-gray-200 text-gray-700 px-5 py-2 rounded-lg font-medium hover:bg-gray-300 transition-colors"
                >
                  Xem Demo Chi·∫øn D·ªãch
                </button>
                <button
                  type="submit"
                  class="bg-blue-600 text-white px-5 py-2 rounded-lg font-medium hover:bg-blue-700 transition-colors shadow"
                >
                  L∆∞u & K√≠ch ho·∫°t
                </button>
              </div>
            </form>
          </section>
        </div>

        <div id="dashboardView" class="hidden">
          <section class="bg-white p-6 rounded-lg shadow-lg">
            <h2 class="text-2xl font-semibold mb-1">
              üìä B∆∞·ªõc 6: Qu·∫£n tr·ªã Hi·ªáu su·∫•t & T·ªëi ∆∞u (The "Result")
            </h2>
            <p class="text-gray-600 mb-6">
              Theo d√µi hi·ªáu su·∫•t c·ªßa t·∫•t c·∫£ c√°c chi·∫øn d·ªãch ƒë√£ v√† ƒëang ch·∫°y.
            </p>

            <div class="overflow-x-auto">
              <table class="min-w-full divide-y divide-gray-200">
                <thead class="bg-gray-50">
                  <tr>
                    <th
                      class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                    >
                      T√™n Chi·∫øn D·ªãch
                    </th>
                    <th
                      class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                    >
                      Ph√¢n Kh√∫c / Logic
                    </th>
                    <th
                      class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                    >
                      Ng√¢n S√°ch
                    </th>
                    <th
                      class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                    >
                      Doanh Thu
                    </th>
                    <th
                      class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                    >
                      ROI
                    </th>
                    <th
                      class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                    >
                      H√†nh ƒê·ªông
                    </th>
                    <th
                      class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                    >
                      Tr·∫°ng Th√°i
                    </th>
                  </tr>
                </thead>
                <tbody
                  id="campaign-table-body"
                  class="bg-white divide-y divide-gray-200"
                >
                  <tr>
                    <td
                      colspan="7"
                      class="px-6 py-10 text-center text-gray-500"
                    >
                      Ch∆∞a c√≥ chi·∫øn d·ªãch n√†o.
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </section>
        </div>
      </main>
    </div>

    <div id="demoModal" class="modal">
      <div class="modal-content w-full max-w-2xl transform transition-all">
        <div classs="p-6">
          <h3 class="text-2xl font-bold text-gray-900 mb-4">
            T√ìM T·∫ÆT CHI·∫æN D·ªäCH
          </h3>
          <div class="space-y-3">
            <div class="flex justify-between">
              <span class="text-gray-500 font-medium">N·ªÅn t·∫£ng:</span>
              <span
                id="demo-platform"
                class="font-semibold text-gray-800"
              ></span>
            </div>
            <div class="flex justify-between">
              <span class="text-gray-500 font-medium">M·ª•c ti√™u:</span>
              <span id="demo-goal" class="font-semibold text-gray-800"></span>
            </div>
            <div class="flex justify-between">
              <span class="text-gray-500 font-medium">Ph√¢n kh√∫c / Logic:</span>
              <span
                id="demo-segment"
                class="font-semibold text-gray-800"
              ></span>
            </div>
            <div class="flex justify-between">
              <span class="text-gray-500 font-medium">Chi·∫øn thu·∫≠t:</span>
              <span id="demo-tactic" class="font-semibold text-gray-800"></span>
            </div>
            <div class="flex justify-between">
              <span class="text-gray-500 font-medium">Ng√¢n s√°ch:</span>
              <span id="demo-budget" class="font-semibold text-gray-800"></span>
            </div>
            <div class="flex justify-between">
              <span class="text-gray-500 font-medium">Th·ªùi gian:</span>
              <span
                id="demo-duration"
                class="font-semibold text-gray-800"
              ></span>
            </div>
            <div class="flex justify-between">
              <span class="text-gray-500 font-medium">KPIs:</span>
              <span id="demo-kpi" class="font-semibold text-gray-800"></span>
            </div>

            <div
              id="demo-dynamic-details"
              class="pt-4 border-t border-gray-200"
            ></div>
          </div>

          <div class="flex justify-between items-center mt-8">
            <button
              class_name="flex items-center space-x-2 bg-green-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-green-700 transition-colors"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="20"
                height="20"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
              >
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" />
                <polyline points="7 10 12 15 17 10" />
                <line x1="12" y1="15" x2="12" y2="3" />
              </svg>
              <span>M√¥ ph·ªèng Xu·∫•t File KH (CSV)</span>
            </button>
            <button
              onclick="app.closeModal('demoModal')"
              class="bg-gray-200 text-gray-700 px-5 py-2 rounded-lg font-medium hover:bg-gray-300 transition-colors"
            >
              ƒê√≥ng
            </button>
          </div>
        </div>
      </div>
    </div>

    <div id="resultModal" class="modal">
      <div class="modal-content w-full max-w-md transform transition-all">
        <form id="result-form">
          <h3 class="text-xl font-semibold text-gray-900 mb-4">
            Nh·∫≠p K·∫øt Qu·∫£ Th·ª±c T·∫ø
          </h3>
          <p class="text-sm text-gray-600 mb-4">
            Nh·∫≠p doanh thu th·ª±c t·∫ø thu v·ªÅ t·ª´ chi·∫øn d·ªãch
            <strong id="result-campaign-name"></strong> ƒë·ªÉ h·ªá th·ªëng t√≠nh to√°n
            ROI.
          </p>
          <div>
            <label
              for="campaign-revenue"
              class="block text-sm font-medium text-gray-700"
              >Doanh thu Th·ª±c t·∫ø (VNƒê)</label
            >
            <input
              type="number"
              id="campaign-revenue"
              class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"
              placeholder="0"
              required
            />
            <input type="hidden" id="campaign-index-input" />
          </div>
          <div class="flex justify-end space-x-3 mt-6">
            <button
              type="button"
              onclick="app.closeModal('resultModal')"
              class="bg-gray-200 text-gray-700 px-4 py-2 rounded-lg font-medium hover:bg-gray-300 transition-colors"
            >
              H·ªßy
            </button>
            <button
              type="submit"
              class="bg-blue-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-blue-700 transition-colors shadow"
            >
              L∆∞u K·∫øt Qu·∫£
            </button>
          </div>
        </form>
      </div>
    </div>

    <script>
      // --- D·ªÆ LI·ªÜU MOCK (MOCK DATA) ---
      // D·ªØ li·ªáu m√¥ ph·ªèng ƒë√£ ƒë∆∞·ª£c c·∫≠p nh·∫≠t theo y√™u c·∫ßu

      const mockData = {
        // B∆∞·ªõc 2 (c≈© l√† 1): M·ª•c ti√™u
        objectives: [
          {
            id: "awareness",
            icon: "üöÄ",
            title: "TƒÉng Nh·∫≠n di·ªán & T∆∞∆°ng t√°c",
            description:
              "Ti·∫øp c·∫≠n v√† t√°i t∆∞∆°ng t√°c v·ªõi c√°c ph√¢n kh√∫c kh√°ch h√†ng hi·ªán c√≥.",
          },
          {
            id: "revenue",
            icon: "üí∞",
            title: "T·ªëi ∆∞u h√≥a Doanh thu",
            description:
              "Th√∫c ƒë·∫©y doanh s·ªë t·ª´ t·ªáp kh√°ch h√†ng hi·ªán t·∫°i, ƒë·∫∑c bi·ªát l√† nh√≥m c√≥ gi√° tr·ªã cao.",
          },
          {
            id: "conversion",
            icon: "üéØ",
            title: "Gia tƒÉng T·ª∑ l·ªá Chuy·ªÉn ƒë·ªïi",
            description:
              'T·ªëi ∆∞u h√≥a h√†nh tr√¨nh kh√°ch h√†ng v√† x·ª≠ l√Ω c√°c "ƒëi·ªÉm ngh·∫Ωn".',
          },
          {
            id: "launch",
            icon: "‚ú®",
            title: "Ra m·∫Øt S·∫£n ph·∫©m M·ªõi",
            description:
              "Gi·ªõi thi·ªáu s·∫£n ph·∫©m m·ªõi ƒë·∫øn c√°c ph√¢n kh√∫c c√≥ kh·∫£ nƒÉng ti·∫øp nh·∫≠n cao nh·∫•t.",
          },
        ],

        // D·ªÆ LI·ªÜU C≈® (D√ôNG CHO FALLBACK N·∫æU C·∫¶N)
        segments: {
          awareness: ["dormant"],
          revenue: ["loyal", "vip"],
          conversion: ["cart_abandoned", "considering"],
          launch: ["innovators", "loyal_launch"],
        },
        segmentDetails: {
          // (Gi·ªØ nguy√™n to√†n b·ªô chi ti·∫øt segment c≈©... v√≠ d·ª•: dormant, loyal, vip...)
          dormant: {
            id: "dormant",
            name: "Kh√°ch h√†ng Ng·ªß ƒë√¥ng (Cluster 1)",
            icon: "üò¥",
            rfm: "R=1 | F=2 | M=2",
            size: "4,500 KH (15.0%)",
            aov: 550000,
            buy: "Th·ªùi trang n·ªØ (c≈©)",
            activity: "Kh√¥ng c·ªë ƒë·ªãnh",
            geo: "TP. H·ªì Ch√≠ Minh (40%)",
            behavior_title: "H·ªì s∆° H√†nh vi (Nguy c∆° r·ªùi b·ªè)",
            behavior_desc: `<p>H√†nh vi: Kh√¥ng mua h√†ng trong > 180 ng√†y. Kh√¥ng m·ªü email, kh√¥ng truy c·∫≠p web.</p>`,
          },
          loyal: {
            id: "loyal",
            name: "Kh√°ch h√†ng Trung th√†nh (Cluster 2)",
            icon: "üíé",
            rfm: "R=5 | F=5 | M=4",
            size: "2,150 KH (15.2%)",
            aov: 1800000,
            buy: "Th·ªùi trang c√¥ng s·ªü, Ph·ª• ki·ªán da",
            activity: "20:00 - 22:00, Th·ª© 3 & Ch·ªß Nh·∫≠t",
            geo: "TP. H·ªì Ch√≠ Minh (55%), H√† N·ªôi (30%)",
            behavior_title: "H·ªì s∆° H√†nh vi (Gi·ªØ ch√¢n & Upsell)",
            behavior_desc: `<p>H√†nh vi: T·∫ßn su·∫•t mua h√†ng cao (F>3), AOV cao. Ph·∫£n h·ªìi t√≠ch c·ª±c v·ªõi email.</p>`,
          },
          vip: {
            id: "vip",
            name: "Kh√°ch h√†ng VIP (Cluster 3)",
            icon: "üëë",
            rfm: "R=4 | F=4 | M=5",
            size: "850 KH (5.1%)",
            aov: 4500000,
            buy: "S·∫£n ph·∫©m cao c·∫•p, ƒê∆°n h√†ng l·ªõn",
            activity: "12:00 - 14:00, Th·ª© 2",
            geo: "TP. H·ªì Ch√≠ Minh (60%), H√† N·ªôi (25%)",
            behavior_title: "H·ªì s∆° H√†nh vi (ChƒÉm s√≥c ƒë·∫∑c bi·ªát)",
            behavior_desc: `<p>H√†nh vi: Chi ti√™u nhi·ªÅu nh·∫•t (M=5), AOV r·∫•t cao. T·∫ßn su·∫•t ·ªïn ƒë·ªãnh.</p>`,
          },
          cart_abandoned: {
            id: "cart_abandoned",
            name: "Kh√°ch h√†ng b·ªè gi·ªè h√†ng (Cluster 4)",
            icon: "üõí",
            rfm: "R=5 | F=2 | M=2",
            size: "1,800 KH (Trong 7 ng√†y)",
            aov: 950000,
            buy: "ƒêa d·∫°ng",
            activity: "21:00 - 23:00 (Gi·ªù cao ƒëi·ªÉm)",
            geo: "To√†n qu·ªëc",
            behavior_title: "H·ªì s∆° H√†nh vi (N√≥ng)",
            behavior_desc: `<p>H√†nh vi: ƒê√£ th√™m s·∫£n ph·∫©m v√†o gi·ªè nh∆∞ng kh√¥ng ho√†n t·∫•t. V·ª´a truy c·∫≠p (R=5).</p>`,
          },
          considering: {
            id: "considering",
            name: "Kh√°ch h√†ng ƒëang c√¢n nh·∫Øc (Cluster 5)",
            icon: "ü§î",
            rfm: "R=4 | F=1 | M=1",
            size: "3,200 KH (10.5%)",
            aov: 1100000,
            buy: "S·∫£n ph·∫©m c√¥ng ngh·ªá, Gia d·ª•ng",
            activity: "Cu·ªëi tu·∫ßn",
            geo: "C√°c th√†nh ph·ªë l·ªõn",
            behavior_title: "H·ªì s∆° H√†nh vi (·∫§m)",
            behavior_desc: `<p>H√†nh vi: Xem trang s·∫£n ph·∫©m nhi·ªÅu l·∫ßn (>3 l·∫ßn/2 ng√†y) ho·∫∑c ƒë√£ g·ª≠i y√™u c·∫ßu t∆∞ v·∫•n. Ch∆∞a mua (F=1).</p>`,
          },
          innovators: {
            id: "innovators",
            name: "Kh√°ch h√†ng ƒê·ªïi m·ªõi (Cluster 6)",
            icon: "üí°",
            rfm: "R=4 | F=4 | M=4",
            size: "1.500 KH (7.8%)",
            aov: 1650000,
            buy: "S·∫£n ph·∫©m danh m·ª•c t∆∞∆°ng t·ª±",
            activity: "Gi·ªù h√†nh ch√≠nh",
            geo: "H√† N·ªôi (40%), ƒê√† N·∫µng (20%)",
            behavior_title: "H·ªì s∆° H√†nh vi (Early Adopters)",
            behavior_desc: `<p>H√†nh vi: Th∆∞·ªùng xuy√™n mua c√°c s·∫£n ph·∫©m thu·ªôc "Danh m·ª•c T∆∞∆°ng t·ª±" ho·∫∑c c√≥ t∆∞∆°ng t√°c cao tr√™n MXH. RFM t·ªët.</p>`,
          },
          loyal_launch: {
            id: "loyal_launch",
            name: "Kh√°ch h√†ng Trung th√†nh (Cho SP m·ªõi)",
            icon: "üíñ",
            rfm: "R=5 | F=5 | M=4",
            size: "2,150 KH (15.2%)",
            aov: 1800000,
            buy: "Th·ªùi trang c√¥ng s·ªü",
            activity: "20:00 - 22:00, Th·ª© 3 & Ch·ªß Nh·∫≠t",
            geo: "TP. H·ªì Ch√≠ Minh (55%)",
            behavior_title: "H·ªì s∆° H√†nh vi (Tin t∆∞·ªüng)",
            behavior_desc: `<p>H√†nh vi: Gi·ªëng h·ªát t·ªáp "Kh√°ch h√†ng Trung th√†nh". Tin t∆∞·ªüng th∆∞∆°ng hi·ªáu.</p>`,
          },
        },
        tactics: {
          default: {
            owned: [
              {
                id: "email_auto",
                name: "G·ª≠i Email/Zalo T·ª± ƒë·ªông",
                desc: "G·ª≠i m√£ ∆∞u ƒë√£i, th√¥ng b√°o c√° nh√¢n h√≥a.",
              },
            ],
            marketplace: [
              {
                id: "mp_ads",
                name: "Qu·∫£ng c√°o tr·∫£ ph√≠ (Ads)",
                desc: "Ch·∫°y qu·∫£ng c√°o s·∫£n ph·∫©m tr√™n s√†n.",
              },
            ],
          },
        },
        tacticRecommendations: {
          dormant: ["email_auto", "mp_voucher"],
          loyal: ["email_auto"],
        },

        // *** B·ªò QUY T·∫ÆC CHO K√äNH S·ªû H·ªÆU (OWNED) - GI·ªÆ NGUY√äN ***
        mockDataOwned: {
          segments: {
            revenue: ["vip_special"],
            conversion: ["new_customer"],
            awareness: ["at_risk"],
            launch: ["vip_launch", "loyal_launch_special"],
          },
          segmentDetails: {
            vip_special: {
              id: "vip_special",
              name: "C·ª•m 1: Kh√°ch h√†ng VIP (Champions)",
              icon: "üëë",
              rfm: "M=Cao, R=Th·∫•p",
              size: "N/A",
              aov: 0,
              buy: "N/A",
              activity: "N/A",
              geo: "N/A",
              behavior_title: "Logic (ƒêi·ªÅu ki·ªán K-Means)",
              behavior_desc: `<p>H·ªá th·ªëng t·ª± ƒë·ªông ch·ªçn c·ª•m c√≥ ch·ªâ s·ªë M (Monetary) trung b√¨nh cao nh·∫•t V√Ä R (Recency) th·∫•p (v√¨ h·ªç ƒëang ho·∫°t ƒë·ªông).</p>`,
            },
            new_customer: {
              id: "new_customer",
              name: "C·ª•m 4: Kh√°ch h√†ng M·ªõi (New Customers)",
              icon: "üå±",
              rfm: "F=1, R=Th·∫•p",
              size: "N/A",
              aov: 0,
              buy: "N/A",
              activity: "N/A",
              geo: "N/A",
              behavior_title: "Logic (ƒêi·ªÅu ki·ªán K-Means)",
              behavior_desc: `<p>"ƒêi·ªÉm ngh·∫Ωn" l·ªõn nh·∫•t... H·ªá th·ªëng ch·ªçn c·ª•m c√≥ ch·ªâ s·ªë F (Frequency) th·∫•p nh·∫•t (th∆∞·ªùng = 1) V√Ä R th·∫•p (v·ª´a mua xong).</p>`,
            },
            at_risk: {
              id: "at_risk",
              name: "C·ª•m 3: Kh√°ch h√†ng c√≥ Nguy c∆° (At-Risk)",
              icon: "üòü",
              rfm: "R=Cao, F=Cao, M=Cao",
              size: "N/A",
              aov: 0,
              buy: "N/A",
              activity: "N/A",
              geo: "N/A",
              behavior_title: "Logic (ƒêi·ªÅu ki·ªán K-Means)",
              behavior_desc: `<p>"T√°i t∆∞∆°ng t√°c" quan tr·ªçng nh·∫•t... H·ªá th·ªëng ch·ªçn c·ª•m c√≥ R cao (l√¢u ch∆∞a mua) nh∆∞ng F v√† M (tr∆∞·ªõc ƒë√¢y) l·∫°i cao.</p>`,
            },
            vip_launch: {
              id: "vip_launch",
              name: "C·ª•m 1: VIP (Champions)",
              icon: "üëë",
              rfm: "R=Th·∫•p, F=Cao/TB",
              size: "N/A",
              aov: 0,
              buy: "N/A",
              activity: "N/A",
              geo: "N/A",
              behavior_title: "Logic (ƒêi·ªÅu ki·ªán K-Means)",
              behavior_desc: `<p>"Kh·∫£ nƒÉng ti·∫øp nh·∫≠n cao nh·∫•t"... H·ªá th·ªëng ch·ªçn 2 c·ª•m c√≥ R th·∫•p (ƒëang ho·∫°t ƒë·ªông) v√† F cao/trung b√¨nh (mua th∆∞·ªùng xuy√™n).</p>`,
            },
            loyal_launch_special: {
              id: "loyal_launch_special",
              name: "C·ª•m 2: Trung th√†nh (Loyal)",
              icon: "üíé",
              rfm: "R=Th·∫•p, F=Cao/TB",
              size: "N/A",
              aov: 0,
              buy: "N/A",
              activity: "N/A",
              geo: "N/A",
              behavior_title: "Logic (ƒêi·ªÅu ki·ªán K-Means)",
              behavior_desc: `<p>"Kh·∫£ nƒÉng ti·∫øp nh·∫≠n cao nh·∫•t"... H·ªá th·ªëng ch·ªçn 2 c·ª•m c√≥ R th·∫•p (ƒëang ho·∫°t ƒë·ªông) v√† F cao/trung b√¨nh (mua th∆∞·ªùng xuy√™n).</p>`,
            },
          },
          tactics: {
            vip_special: {
              owned: [
                {
                  id: "privilege",
                  name: "Ch∆∞∆°ng tr√¨nh ƒê·∫∑c quy·ªÅn (Kh√¥ng gi·∫£m gi√°)",
                  desc: "Early Access, Qu√† t·∫∑ng Sinh nh·∫≠t V·∫≠t l√Ω, Freeship Vƒ©nh vi·ªÖn.",
                },
                {
                  id: "upsell_email",
                  name: "Chi·∫øn d·ªãch Upsell C√° nh√¢n h√≥a",
                  desc: "G·ª≠i email t·ª± ƒë·ªông gi·ªõi thi·ªáu s·∫£n ph·∫©m cao c·∫•p, phi√™n b·∫£n gi·ªõi h·∫°n.",
                },
                {
                  id: "referral",
                  name: "Ch∆∞∆°ng tr√¨nh Gi·ªõi thi·ªáu (Referral)",
                  desc: "Bi·∫øn h·ªç th√†nh ƒë·∫°i s·ª©. T·∫∑ng m√£ gi·ªõi thi·ªáu cho b·∫°n b√®.",
                },
              ],
              marketplace: [],
            },
            new_customer: {
              owned: [
                {
                  id: "onboarding",
                  name: "Chu·ªói Email/Zalo Onboarding (T·ª± ƒë·ªông)",
                  desc: "Ng√†y 1: C·∫£m ∆°n, Ng√†y 3: C·ªông ƒë·ªìng, Ng√†y 7: M√£ gi·∫£m gi√° 15% (h·∫°n 3 ng√†y).",
                },
                {
                  id: "web_welcome",
                  name: "C√° nh√¢n h√≥a Tr·∫£i nghi·ªám Web",
                  desc: 'Hi·ªÉn th·ªã Popup "Ch√†o m·ª´ng tr·ªü l·∫°i! D√πng m√£ [WELCOME15]..."',
                },
              ],
              marketplace: [],
            },
            at_risk: {
              owned: [
                {
                  id: "win_back",
                  name: 'Chi·∫øn d·ªãch "Win-back" T·ª± ƒë·ªông',
                  desc: 'G·ª≠i Email "Ch√∫ng t√¥i nh·ªõ b·∫°n!" v·ªõi m√£ gi·∫£m gi√° gi√° tr·ªã cao (25% ho·∫∑c M1T1).',
                },
                {
                  id: "remarketing_multi",
                  name: "Remarketing ƒêa n·ªÅn t·∫£ng",
                  desc: "ƒê·∫©y t·ªáp email/SƒêT sang Facebook/Google Ads v·ªõi th√¥ng ƒëi·ªáp BST M·ªõi.",
                },
                {
                  id: "survey",
                  name: "Kh·∫£o s√°t Kh√°ch h√†ng",
                  desc: 'G·ª≠i email kh·∫£o s√°t "T·∫°i sao b·∫°n ch∆∞a quay l·∫°i?" v√† t·∫∑ng voucher 50k.',
                },
              ],
              marketplace: [],
            },
            vip_launch: {
              owned: [
                {
                  id: "early_access",
                  name: "M·ªü b√°n S·ªõm (Exclusive Early Access)",
                  desc: "G·ª≠i email/Zalo cho c·ª•m n√†y mua tr∆∞·ªõc c√¥ng ch√∫ng 1-2 ng√†y.",
                },
                {
                  id: "cross_sell",
                  name: "T·∫°o Combo B√°n ch√©o (Cross-sell)",
                  desc: 'T·∫°o combo "S·∫£n ph·∫©m m·ªõi + S·∫£n ph·∫©m b√°n ch·∫°y nh·∫•t (m√† h·ªç hay mua)".',
                },
                {
                  id: "seeding",
                  name: 'Thu th·∫≠p "H·∫°t gi·ªëng" ƒê√°nh gi√° (Seeding)',
                  desc: "T·∫∑ng/b√°n gi√° v·ªën cho 20 kh√°ch VIP nh·∫•t ƒë·ªÉ l·∫•y ƒë√°nh gi√° chi ti·∫øt.",
                },
              ],
              marketplace: [],
            },
            loyal_launch_special: {
              owned: [
                {
                  id: "early_access",
                  name: "M·ªü b√°n S·ªõm (Exclusive Early Access)",
                  desc: "G·ª≠i email/Zalo cho c·ª•m n√†y mua tr∆∞·ªõc c√¥ng ch√∫ng 1-2 ng√†y.",
                },
                {
                  id: "cross_sell",
                  name: "T·∫°o Combo B√°n ch√©o (Cross-sell)",
                  desc: 'T·∫°o combo "S·∫£n ph·∫©m m·ªõi + S·∫£n ph·∫©m b√°n ch·∫°y nh·∫•t (m√† h·ªç hay mua)".',
                },
                {
                  id: "seeding",
                  name: 'Thu th·∫≠p "H·∫°t gi·ªëng" ƒê√°nh gi√° (Seeding)',
                  desc: "T·∫∑ng/b√°n gi√° v·ªën cho kh√°ch h√†ng trung th√†nh ƒë·ªÉ l·∫•y ƒë√°nh gi√° chi ti·∫øt.",
                },
              ],
              marketplace: [],
            },
          },
          tacticRecommendations: {
            vip_special: ["privilege", "upsell_email", "referral"],
            new_customer: ["onboarding", "web_welcome"],
            at_risk: ["win_back", "remarketing_multi", "survey"],
            vip_launch: ["early_access", "cross_sell", "seeding"],
            loyal_launch_special: ["early_access", "cross_sell", "seeding"],
          },
        },

        // *** B·ªò QUY T·∫ÆC M·ªöI CHO K√äNH S√ÄN TMƒêT (MARKETPLACE) - ƒê√É C·∫¨P NH·∫¨T ***
        mockDataMarketplace: {
          // *** M·ªöI: D·ªØ li·ªáu cho Card t·ª∑ l·ªá % ***
          // ƒê√¢y l√† K·ªãch b·∫£n 2: T·ªáp "Ng·ªß qu√™n" (Nhi·ªÅu kh√°ch Nguy c∆°)
          segmentDistribution: [
            {
              id: "mp_vip",
              name: "VIP (Champions)",
              percentage: 5,
              color: "bg-yellow-400",
            },
            {
              id: "mp_loyal",
              name: "Trung th√†nh (Loyal)",
              percentage: 10,
              color: "bg-blue-500",
            },
            {
              id: "mp_at_risk",
              name: "Nguy c∆° (At-Risk)",
              percentage: 60,
              color: "bg-red-500",
            },
            {
              id: "mp_new",
              name: "M·ªõi (New)",
              percentage: 25,
              color: "bg-green-400",
            },
            // { id: 'mp_lost', name: 'ƒê√£ m·∫•t (Lost)', percentage: 5, color: 'bg-gray-400' } // B·ªè b·ªõt 1 c·ª•m ƒë·ªÉ d·ªÖ nh√¨n
          ],

          // B∆∞·ªõc 4 M·ªõi: Lu√¥n c√≥ 5 chi·∫øn thu·∫≠t n√†y
          tactics: {
            owned: [], // S√†n TMƒêT kh√¥ng c√≥ k·ªãch b·∫£n owned
            marketplace: [
              {
                id: "mp_ads",
                name: "Qu·∫£ng c√°o tr·∫£ ph√≠ (Ads)",
                desc: "Ti·∫øp th·ªã l·∫°i (C·ª•m M·ªõi) ho·∫∑c T√¨m ki·∫øm (t·ªáp m·ªõi).",
              },
              {
                id: "mp_flash_sale",
                name: "Flash Sale",
                desc: "K√≠ch ho·∫°t C·ª•m Nguy c∆° v√† C·ª•m ƒê√£ m·∫•t.",
              },
              {
                id: "mp_voucher",
                name: "Voucher / Coupon",
                desc: "C√¥ng c·ª• linh ho·∫°t: G·ª≠i chat (VIP) ho·∫∑c Follower (M·ªõi).",
              },
              {
                id: "mp_livestream",
                name: "Livestream",
                desc: "T∆∞∆°ng t√°c & ch·ªët ƒë∆°n t·ªáp Trung th√†nh, Nguy c∆°, M·ªõi.",
              },
              {
                id: "mp_combo",
                name: "Combo mua k√®m (Bundle Deals)",
                desc: "TƒÉng AOV cho t·∫•t c·∫£ c√°c c·ª•m, ƒë·∫∑c bi·ªát l√† VIP, Trung th√†nh.",
              },
            ],
          },
        },

        // B∆∞·ªõc 5 (c≈© l√† 4): Bi·ªÉu m·∫´u ƒë·ªông cho chi·∫øn thu·∫≠t Marketplace (GI·ªÆ NGUY√äN)
        marketplaceFormSnippets: {
          mp_ads: `
                    <p class="text-sm text-gray-600 mb-4">C·∫•u h√¨nh cho chi·∫øn d·ªãch Qu·∫£ng c√°o tr·∫£ ph√≠ tr√™n S√†n TMƒêT.</p>
                    <div class="space-y-4">
                        <div>
                            <label for="tactic-ads-product" class="block text-sm font-medium text-gray-700">S·∫£n ph·∫©m qu·∫£ng c√°o</label>
                            <input type="text" id="tactic-ads-product" placeholder="Vd: √Åo s∆° mi tr·∫Øng" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500">
                        </div>
                        <div>
                            <label for="tactic-ads-keywords" class="block text-sm font-medium text-gray-700">T·ª´ kh√≥a m·ª•c ti√™u (c√°ch nhau b·∫±ng d·∫•u ph·∫©y)</label>
                            <input type="text" id="tactic-ads-keywords" placeholder="Vd: √°o s∆° mi, s∆° mi c√¥ng s·ªü" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500">
                        </div>
                        <div>
                            <label for="tactic-ads-cpc" class="block text-sm font-medium text-gray-700">CPC mong mu·ªën (VNƒê)</label>
                            <input type="number" id="tactic-ads-cpc" placeholder="1000" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500">
                        </div>
                    </div>
                `,
          mp_flash_sale: `
                    <p class="text-sm text-gray-600 mb-4">C·∫•u h√¨nh cho chi·∫øn d·ªãch Flash Sale tr√™n S√†n TMƒêT.</p>
                    <div class="space-y-4">
                        <div>
                            <label for="tactic-fs-product" class="block text-sm font-medium text-gray-700">S·∫£n ph·∫©m tham gia</label>
                            <input type="text" id="tactic-fs-product" placeholder="Vd: Gi√†y da nam" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500">
                        </div>
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label for="tactic-fs-price" class="block text-sm font-medium text-gray-700">Gi√° gi·∫£m (VNƒê)</label>
                                <input type="number" id="tactic-fs-price" placeholder="199000" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500">
                            </div>
                            <div>
                                <label for="tactic-fs-limit" class="block text-sm font-medium text-gray-700">Gi·ªõi h·∫°n s·ªë l∆∞·ª£ng</label>
                                <input type="number" id="tactic-fs-limit" placeholder="100" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500">
                            </div>
                        </div>
                        <div>
                            <label for="tactic-fs-time" class="block text-sm font-medium text-gray-700">Th·ªùi gian b·∫Øt ƒë·∫ßu (ch·ªçn slot c·ªßa s√†n)</label>
                            <input type="datetime-local" id="tactic-fs-time" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500">
                        </div>
                    </div>
                `,
          mp_voucher: `
                    <p class="text-sm text-gray-600 mb-4">C·∫•u h√¨nh cho chi·∫øn d·ªãch Voucher / Coupon tr√™n S√†n TMƒêT.</p>
                    <div class="space-y-4">
                        <div>
                            <label for="tactic-voucher-type" class="block text-sm font-medium text-gray-700">Lo·∫°i Voucher</label>
                            <select id="tactic-voucher-type" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500">
                                <option>Gi·∫£m theo %</option>
                                <option>Gi·∫£m theo s·ªë ti·ªÅn</option>
                                <option>Freeship</option>
                            </select>
                        </div>
                        <div class="grid grid-cols-2 gap-4">
                                <div>
                                <label for="tactic-voucher-code" class="block text-sm font-medium text-gray-700">M√£ gi·∫£m gi√°</label>
                                <input type="text" id="tactic-voucher-code" placeholder="SHOPVIP10" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500">
                            </div>
                                <div>
                                <label for="tactic-voucher-value" class="block text-sm font-medium text-gray-700">Gi√° tr·ªã (VND ho·∫∑c %)</label>
                                <input type="number" id="tactic-voucher-value" placeholder="10" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500">
                            </div>
                        </div>
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label for="tactic-voucher-min" class="block text-sm font-medium text-gray-700">ƒê∆°n t·ªëi thi·ªÉu (VNƒê)</label>
                                <input type="number" id="tactic-voucher-min" placeholder="99000" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500">
                            </div>
                            <div>
                                <label for="tactic-voucher-limit" class="block text-sm font-medium text-gray-700">L∆∞·ª£t d√πng t·ªëi ƒëa</label>
                                <input type="number" id="tactic-voucher-limit" placeholder="500" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500">
                            </div>
                        </div>
                    </div>
                `,
          mp_livestream: `
                    <p class="text-sm text-gray-600 mb-4">C·∫•u h√¨nh cho chi·∫øn d·ªãch Livestream tr√™n S√†n TMƒêT.</p>
                    <div class="space-y-4">
                        <div>
                            <label for="tactic-live-title" class="block text-sm font-medium text-gray-700">Ti√™u ƒë·ªÅ Livestream</label>
                            <input type="text" id="tactic-live-title" placeholder="Si√™u Sale 11.11 - Gi·∫£m S·ªëc" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500">
                        </div>
                        <div>
                            <label for="tactic-live-time" class="block text-sm font-medium text-gray-700">Th·ªùi gian Livestream</label>
                            <input type="datetime-local" id="tactic-live-time" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500">
                        </div>
                        <div>
                            <label for="tactic-live-script" class="block text-sm font-medium text-gray-700">K·ªãch b·∫£n / M√¥ t·∫£ ng·∫Øn</label>
                            <textarea id="tactic-live-script" rows="2" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"></textarea>
                        </div>
                        <div>
                            <label for="tactic-live-products" class="block text-sm font-medium text-gray-700">Link s·∫£n ph·∫©m ghim (c√°ch nhau b·∫±ng d·∫•u ph·∫©y)</label>
                            <input type="text" id="tactic-live-products" placeholder="link1, link2,..." class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500">
                        </div>
                    </div>
                `,
          mp_combo: `
                    <p class="text-sm text-gray-600 mb-4">C·∫•u h√¨nh cho chi·∫øn d·ªãch Combo Mua K√®m tr√™n S√†n TMƒêT.</p>
                    <div class="space-y-4">
                        <div>
                            <label for="tactic-combo-main" class="block text-sm font-medium text-gray-700">S·∫£n ph·∫©m ch√≠nh</label>
                            <input type="text" id="tactic-combo-main" placeholder="Vd: √Åo s∆° mi" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500">
                        </div>
                        <div>
                            <label for="tactic-combo-sub" class="block text-sm font-medium text-gray-700">S·∫£n ph·∫©m ph·ª• (mua k√®m)</label>
                            <input type="text" id="tactic-combo-sub" placeholder="Vd: C√† v·∫°t" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500">
                        </div>
                        <div>
                            <label for="tactic-combo-price" class="block text-sm font-medium text-gray-700">Gi√° combo ∆∞u ƒë√£i (VNƒê)</label>
                            <input type="number" id="tactic-combo-price" placeholder="249000" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500">
                        </div>
                    </div>
                `,
        },
      };

      // --- L√ïI ·ª®NG D·ª§NG (APP CORE) ---

      class MarketingApp {
        constructor(data) {
          this.data = data;
          // Tr·∫°ng th√°i (State) c·ªßa ·ª©ng d·ª•ng - ƒê√É C·∫¨P NH·∫¨T
          this.state = {
            currentStep: 1,
            selectedPlatform: null, // *** M·ªöI: 'owned' | 'marketplace'
            selectedObjective: null, // {id, title}
            selectedSegment: null, // {id, name}
            selectedTactic: null, // {id, name, type: 'owned' | 'marketplace'}
            campaigns: [], // {id, name, segment, status, budget, revenue, ...}
          };

          // DOM Elements - ƒê√É C·∫¨P NH·∫¨T
          this.ui = {
            wizardView: document.getElementById("wizardView"),
            dashboardView: document.getElementById("dashboardView"),
            navCreateNew: document.getElementById("navCreateNew"),
            navDashboard: document.getElementById("navDashboard"),
            steps: {
              1: document.getElementById("step-1"), // M·ªõi: N·ªÅn t·∫£ng
              2: document.getElementById("step-2"), // M·ª•c ti√™u
              3: document.getElementById("step-3"), // Ph√¢n kh√∫c
              4: document.getElementById("step-4"), // Chi·∫øn thu·∫≠t
              5: document.getElementById("step-5"), // Thi·∫øt k·∫ø
            },
            steppers: {
              1: document.getElementById("stepper-1"), // M·ªõi: N·ªÅn t·∫£ng
              2: document.getElementById("stepper-2"), // M·ª•c ti√™u
              3: document.getElementById("stepper-3"), // Ph√¢n kh√∫c
              4: document.getElementById("stepper-4"), // Chi·∫øn thu·∫≠t
              5: document.getElementById("stepper-5"), // Thi·∫øt k·∫ø
              6: document.getElementById("stepper-6"), // Ho√†n t·∫•t
            },
            // (Step 2 - M·ª•c ti√™u)
            step2Title: document.getElementById("step-2-title"),
            step2Desc: document.getElementById("step-2-desc"),
            goalDashboardContainer: document.getElementById(
              "goal-dashboard-container"
            ),
            // (Step 3 - Ph√¢n kh√∫c)
            selectedGoalText: document.getElementById("selected-goal-text"),
            segmentCardsContainer: document.getElementById(
              "segment-cards-container"
            ),
            // (Step 4 - Chi·∫øn thu·∫≠t)
            selectedSegmentText: document.getElementById(
              "selected-segment-text"
            ),
            ownedChannels: document.getElementById("owned-channels"), // *** M·ªöI: ƒê·ªÉ highlight
            marketplaceChannels: document.getElementById(
              "marketplace-channels"
            ), // *** M·ªöI: ƒê·ªÉ highlight
            ownedTacticsList: document.getElementById("owned-tactics-list"),
            marketplaceTacticsList: document.getElementById(
              "marketplace-tactics-list"
            ),
            step4Grid: document.getElementById("step-4-grid"), // *** M·ªöI: ƒê·ªÉ ƒëi·ªÅu khi·ªÉn grid
            step4BackButton: document.getElementById("step-4-back-button"), // *** M·ªöI: N√∫t Back
            // (Step 5 - Thi·∫øt k·∫ø)
            campaignBuilderForm: document.getElementById(
              "campaign-builder-form"
            ),
            campaignSegmentInput: document.getElementById("campaign-segment"),
            campaignNameInput: document.getElementById("campaign-name"),
            campaignBudetInput: document.getElementById("campaign-budget"),
            campaignKpiInput: document.getElementById("campaign-kpi"),
            campaignStartDateInput: document.getElementById(
              "campaign-start-date"
            ),
            campaignEndDateInput: document.getElementById("campaign-end-date"),
            campaignNotesInput: document.getElementById("campaign-notes"),
            dynamicTacticTitle: document.getElementById("dynamic-tactic-title"),
            dynamicTacticFormFields: document.getElementById(
              "dynamic-tactic-form-fields"
            ),
            // (Dashboard)
            campaignTableBody: document.getElementById("campaign-table-body"),
            // Modals
            demoModal: document.getElementById("demoModal"),
            demoPlatform: document.getElementById("demo-platform"), // *** M·ªöI
            demoGoal: document.getElementById("demo-goal"),
            demoSegment: document.getElementById("demo-segment"),
            demoTactic: document.getElementById("demo-tactic"),
            demoBudget: document.getElementById("demo-budget"),
            demoDuration: document.getElementById("demo-duration"),
            demoKpi: document.getElementById("demo-kpi"),
            demoDynamicDetails: document.getElementById("demo-dynamic-details"),

            resultModal: document.getElementById("resultModal"),
            resultForm: document.getElementById("result-form"),
            resultCampaignName: document.getElementById("result-campaign-name"),
            campaignIndexInput: document.getElementById("campaign-index-input"),
            campaignRevenueInput: document.getElementById("campaign-revenue"),
          };

          this.bindEvents();
          this.init();
        }

        // Kh·ªüi t·∫°o
        init() {
          this.renderStep1(); // B·∫Øt ƒë·∫ßu render B∆∞·ªõc 1 (N·ªÅn t·∫£ng)
          this.updateStepper();
          this.navigateTo("wizard"); // B·∫Øt ƒë·∫ßu ·ªü lu·ªìng t·∫°o
        }

        // G·∫Øn c√°c s·ª± ki·ªán
        bindEvents() {
          // ƒêi·ªÅu h∆∞·ªõng ch√≠nh
          this.ui.navCreateNew.addEventListener("click", () =>
            this.resetWizard()
          );
          this.ui.navDashboard.addEventListener("click", () =>
            this.navigateTo("dashboard")
          );

          // Submit form
          this.ui.campaignBuilderForm.addEventListener("submit", (e) =>
            this.handleSaveCampaign(e)
          );
          this.ui.resultForm.addEventListener("submit", (e) =>
            this.handleSaveResult(e)
          );

          // ƒê√≥ng modal khi click ra ngo√†i
          window.onclick = (event) => {
            if (event.target == this.ui.demoModal) {
              this.closeModal("demoModal");
            }
            if (event.target == this.ui.resultModal) {
              this.closeModal("resultModal");
            }
          };
        }

        // --- QU·∫¢N L√ù TR·∫†NG TH√ÅI & ƒêI·ªÄU H∆Ø·ªöNG ---

        // Chuy·ªÉn view
        navigateTo(viewName) {
          if (viewName === "wizard") {
            this.ui.wizardView.style.display = "block";
            this.ui.dashboardView.style.display = "none";
            this.ui.navCreateNew.classList.add("bg-blue-600", "text-white");
            this.ui.navCreateNew.classList.remove(
              "bg-gray-200",
              "text-gray-700"
            );
            this.ui.navDashboard.classList.add("bg-gray-200", "text-gray-700");
            this.ui.navDashboard.classList.remove("bg-blue-600", "text-white");
          } else if (viewName === "dashboard") {
            this.ui.wizardView.style.display = "none";
            this.ui.dashboardView.style.display = "block";
            this.ui.navDashboard.classList.add("bg-blue-600", "text-white");
            this.ui.navDashboard.classList.remove(
              "bg-gray-200",
              "text-gray-700"
            );
            this.ui.navCreateNew.classList.add("bg-gray-200", "text-gray-700");
            this.ui.navCreateNew.classList.remove("bg-blue-600", "text-white");
            this.renderDashboard();
          }
        }

        // Chuy·ªÉn b∆∞·ªõc (*** ƒê√É C·∫¨P NH·∫¨T LOGIC ***)
        showStep(step) {
          this.state.currentStep = step;
          Object.values(this.ui.steps).forEach((section) =>
            section.classList.remove("active")
          );
          if (this.ui.steps[step]) {
            this.ui.steps[step].classList.add("active");
          }

          // *** LOGIC M·ªöI: C·∫≠p nh·∫≠t n√∫t Back ·ªü B∆∞·ªõc 4 ***
          if (step === 4) {
            if (this.state.selectedPlatform === "marketplace") {
              // N·∫øu l√† Marketplace, B∆∞·ªõc 4 quay v·ªÅ B∆∞·ªõc 2
              this.ui.step4BackButton.setAttribute("onclick", "app.goBack(2)");
              this.ui.step4BackButton.innerHTML =
                "&larr; Quay l·∫°i Dashboard & M·ª•c ti√™u";
            } else {
              // N·∫øu l√† Owned, B∆∞·ªõc 4 quay v·ªÅ B∆∞·ªõc 3
              this.ui.step4BackButton.setAttribute("onclick", "app.goBack(3)");
              this.ui.step4BackButton.innerHTML =
                "&larr; Quay l·∫°i ch·ªçn Ph√¢n kh√∫c";
            }
          }
          // *** K·∫æT TH√öC LOGIC M·ªöI ***

          this.updateStepper();
          window.scrollTo(0, 0); // Cu·ªôn l√™n ƒë·∫ßu trang
        }

        // Quay l·∫°i b∆∞·ªõc tr∆∞·ªõc
        goBack(step) {
          this.showStep(step);
        }

        // Reset lu·ªìng
        resetWizard() {
          this.state.selectedPlatform = null; // *** M·ªöI
          this.state.selectedObjective = null;
          this.state.selectedSegment = null;
          this.state.selectedTactic = null;
          this.ui.campaignBuilderForm.reset();
          this.ui.dynamicTacticFormFields.innerHTML = "";
          this.showStep(1); // Quay v·ªÅ B∆∞·ªõc 1 (N·ªÅn t·∫£ng)
          this.navigateTo("wizard");
          this.updateStepperNames("owned"); // Reset t√™n stepper v·ªÅ m·∫∑c ƒë·ªãnh
        }

        // C·∫≠p nh·∫≠t thanh ti·∫øn tr√¨nh (*** ƒê√É C·∫¨P NH·∫¨T LOGIC ***)
        updateStepper() {
          const currentStep = this.state.currentStep;
          const platform = this.state.selectedPlatform;

          Object.keys(this.ui.steppers).forEach((stepKey) => {
            const stepElement = this.ui.steppers[stepKey];
            stepElement.classList.remove("active", "completed");
            stepElement.style.display = "flex"; // Reset hi·ªÉn th·ªã

            // *** LOGIC M·ªöI: ·∫®n B∆∞·ªõc 3 n·∫øu l√† Marketplace ***
            if (platform === "marketplace" && stepKey == 3) {
              stepElement.style.display = "none"; // ·∫®n B∆∞·ªõc 3
            }

            if (stepKey < currentStep) {
              stepElement.classList.add("completed");
            } else if (stepKey == currentStep) {
              stepElement.classList.add("active");
            }
          });
        }

        // *** M·ªöI: H√†m c·∫≠p nh·∫≠t t√™n Stepper ***
        updateStepperNames(platform) {
          if (platform === "owned") {
            this.ui.steppers[2].querySelector(".step-name").textContent =
              "Ch·ªçn M·ª•c Ti√™u";
            this.ui.steppers[3].querySelector(".step-name").textContent =
              "Ch·ªçn Ph√¢n Kh√∫c";
            this.ui.steppers[4].querySelector(".step-name").textContent =
              "Ch·ªçn Chi·∫øn Thu·∫≠t";
          } else if (platform === "marketplace") {
            // T√™n c√°c b∆∞·ªõc cho lu·ªìng Marketplace
            this.ui.steppers[2].querySelector(".step-name").textContent =
              "Dashboard & M·ª•c Ti√™u"; // B∆∞·ªõc 2 l√† Dashboard + M·ª•c ti√™u
            this.ui.steppers[3].querySelector(".step-name").textContent =
              "(B·ªè qua)"; // B∆∞·ªõc 3 b·ªã b·ªè qua
            this.ui.steppers[4].querySelector(".step-name").textContent =
              "Ch·ªçn Chi·∫øn D·ªãch";
          }
        }

        // --- LOGIC C√ÅC B∆Ø·ªöC (ƒê√É REFACTOR) ---

        // *** B∆Ø·ªöC 1: Render Ch·ªçn N·ªÅn T·∫£ng ***
        renderStep1() {
          // B∆∞·ªõc 1 l√† tƒ©nh trong HTML, kh√¥ng c·∫ßn render
        }

        // *** X·ª≠ l√Ω ch·ªçn B∆∞·ªõc 1 (*** ƒê√É C·∫¨P NH·∫¨T ***) ***
        selectPlatform(platform) {
          this.state.selectedPlatform = platform;

          // C·∫≠p nh·∫≠t l·∫°i t√™n Stepper
          this.updateStepperNames(platform);

          if (platform === "owned") {
            this.renderStep2_Goals(); // Render m·ª•c ti√™u nh∆∞ c≈©
            this.showStep(2);
          } else if (platform === "marketplace") {
            this.renderStep2_MarketplaceDashboard(); // Render Dashboard % V√Ä M·ª•c ti√™u
            this.showStep(2); // V·∫´n l√† showStep(2)
          }
        }

        // *** B∆Ø·ªöC 2: Render c√°c m·ª•c ti√™u (CHO K√äNH OWNED) ***
        renderStep2_Goals() {
          // Reset ti√™u ƒë·ªÅ v·ªÅ m·∫∑c ƒë·ªãnh
          this.ui.step2Title.textContent =
            'B∆∞·ªõc 2: X√°c ƒë·ªãnh M·ª•c ti√™u Chi·∫øn l∆∞·ª£c (The "Why")';
          this.ui.step2Desc.textContent =
            "Ch·ªçn m·ª•c ti√™u kinh doanh c·ªët l√µi ƒë·ªÉ h·ªá th·ªëng ƒë·ªÅ xu·∫•t ph√¢n kh√∫c kh√°ch h√†ng ph√π h·ª£p.";

          let html =
            '<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">';
          this.data.objectives.forEach((goal) => {
            html += `
                        <div class="border border-gray-200 rounded-lg p-5 shadow-sm hover:shadow-xl hover:border-blue-500 transition-all cursor-pointer" 
                             onclick='app.selectObjective(${JSON.stringify(
                               goal.id
                             )}, ${JSON.stringify(goal.title)})'>
                            <span class="text-4xl">${goal.icon}</span>
                            <h3 class="text-xl font-semibold mt-3 mb-2 text-gray-800">${
                              goal.title
                            }</h3>
                            <p class="text-gray-500 text-sm">${
                              goal.description
                            }</p>
                        </div>
                    `;
          });
          html += "</div>";
          this.ui.goalDashboardContainer.innerHTML = html;
        }

        // *** B∆Ø·ªöC 2 (M·ªöI): Render Dashboard + M·ª•c ti√™u (CHO MARKETPLACE) ***
        renderStep2_MarketplaceDashboard() {
          // C·∫≠p nh·∫≠t ti√™u ƒë·ªÅ
          this.ui.step2Title.textContent =
            "B∆∞·ªõc 2: Hi·ªán tr·∫°ng Dashboard & Ch·ªçn M·ª•c ti√™u";
          this.ui.step2Desc.textContent =
            "H·ªá th·ªëng ƒë√£ ph√¢n t√≠ch d·ªØ li·ªáu kh√°ch h√†ng. H√£y xem hi·ªán tr·∫°ng v√† ch·ªçn m·ª•c ti√™u b·∫°n mu·ªën ∆∞u ti√™n.";

          // 1. L·∫•y d·ªØ li·ªáu t·ª∑ l·ªá %
          const distribution =
            this.data.mockDataMarketplace.segmentDistribution;

          // 2. Render Card t·ª∑ l·ªá %
          let dashboardHtml = `
                    <div class="mb-6 p-5 bg-white rounded-lg border shadow-md">
                        <h3 class="text-xl font-semibold text-gray-800 mb-4">Hi·ªán tr·∫°ng Ph√¢n kh√∫c Kh√°ch h√†ng (S√†n TMƒêT)</h3>
                        <div class="w-full flex rounded-full h-8 bg-gray-200 overflow-hidden mb-3 shadow-inner">
                `;
          distribution.forEach((seg) => {
            dashboardHtml += `<div class="${seg.color} h-full transition-all duration-300" style="width: ${seg.percentage}%" title="${seg.name}: ${seg.percentage}%"></div>`;
          });
          dashboardHtml += `
                        </div>
                        <div class="flex flex-wrap justify-center gap-x-4 gap-y-2 text-sm">
                `;
          distribution.forEach((seg) => {
            dashboardHtml += `
                        <div class="flex items-center">
                            <span class="w-3 h-3 rounded-full ${seg.color} mr-2 border border-gray-300"></span>
                            <span class="font-medium text-gray-700">${seg.name}:</span>
                            <span class="text-gray-600 ml-1">${seg.percentage}%</span>
                        </div>
                    `;
          });
          dashboardHtml += `
                        </div>
                    </div>
                    <hr class="my-6 border-gray-200">
                    <h3 class="text-xl font-semibold text-gray-800 mb-5">D·ª±a tr√™n d·ªØ li·ªáu tr√™n, h√£y ch·ªçn m·ªôt m·ª•c ti√™u:</h3>
                `;

          // 3. Render c√°c M·ª•c ti√™u (gi·ªëng h·ªát renderStep2_Goals)
          let goalsHtml =
            '<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">';
          this.data.objectives.forEach((goal) => {
            goalsHtml += `
                        <div class="border border-gray-200 rounded-lg p-5 shadow-sm hover:shadow-xl hover:border-blue-500 transition-all cursor-pointer" 
                             onclick='app.selectObjective(${JSON.stringify(
                               goal.id
                             )}, ${JSON.stringify(goal.title)})'>
                            <span class="text-4xl">${goal.icon}</span>
                            <h3 class="text-xl font-semibold mt-3 mb-2 text-gray-800">${
                              goal.title
                            }</h3>
                            <p class="text-gray-500 text-sm">${
                              goal.description
                            }</p>
                        </div>
                    `;
          });
          goalsHtml += "</div>";

          // 4. G·ªôp v√† render
          this.ui.goalDashboardContainer.innerHTML = dashboardHtml + goalsHtml;
        }

        // X·ª≠ l√Ω ch·ªçn B∆∞·ªõc 2 (*** ƒê√É C·∫¨P NH·∫¨T ***)
        selectObjective(goalId, goalTitle) {
          this.state.selectedObjective = { id: goalId, title: goalTitle };
          this.ui.selectedGoalText.textContent = goalTitle;

          if (this.state.selectedPlatform === "owned") {
            // Lu·ªìng Owned: ƒêi ƒë·∫øn B∆∞·ªõc 3 (Ph√¢n kh√∫c)
            this.renderStep3_Owned();
            this.showStep(3);
          } else if (this.state.selectedPlatform === "marketplace") {
            // Lu·ªìng Marketplace: B·ªé QUA B∆∞·ªõc 3, ƒëi th·∫≥ng ƒë·∫øn B∆∞·ªõc 4 (Chi·∫øn d·ªãch)
            this.renderStep4_Marketplace();
            this.showStep(4);
          }
        }

        // *** B∆Ø·ªöC 3: Render c√°c ph√¢n kh√∫c (CHO K√äNH OWNED) ***
        renderStep3_Owned() {
          let segmentIds =
            this.data.mockDataOwned.segments[this.state.selectedObjective.id] ||
            [];
          let segmentDetailsSource = this.data.mockDataOwned.segmentDetails;

          let html = "";
          segmentIds.forEach((id) => {
            const segment = segmentDetailsSource[id];
            if (!segment) return;

            // (HTML Render y h·ªát code g·ªëc)
            html += `
                        <div class="border border-gray-200 rounded-lg shadow-md overflow-hidden">
                            <div class="p-5 bg-white">
                                <div class="flex justify-between items-start mb-4">
                                    <div>
                                        <h3 class="text-2xl font-bold text-gray-800">${
                                          segment.icon
                                        } ${segment.name}</h3>
                                        <p class="text-sm font-medium text-gray-500">ƒê·ªãnh nghƒ©a RFM: <span class="text-indigo-600 font-semibold">${
                                          segment.rfm
                                        }</span></p>
                                    </div>
                                    <button class="bg-blue-600 text-white px-5 py-2 rounded-lg font-medium hover:bg-blue-700 transition-colors shadow-sm"
                                            onclick='app.selectSegment(${JSON.stringify(
                                              segment.id
                                            )}, ${JSON.stringify(
              segment.name
            )})'>
                                        Ch·ªçn T·ªáp N√†y
                                    </button>
                                </div>
                                
                                <div class="grid grid-cols-2 md:grid-cols-4 gap-4 text-sm mb-5 ${
                                  segment.size === "N/A" ? "hidden" : ""
                                }">
                                    <div class="bg-gray-50 p-3 rounded">
                                        <span class="block text-gray-500">Quy m√¥ t·ªáp</span>
                                        <span class="font-semibold text-gray-800">${
                                          segment.size
                                        }</span>
                                    </div>
                                    <div class="bg-gray-50 p-3 rounded">
                                        <span class="block text-gray-500">ƒê∆°n h√†ng TB (AOV)</span>
                                        <span class="font-semibold text-gray-800">${this.formatCurrency(
                                          segment.aov
                                        )}</span>
                                    </div>
                                    <div class="bg-gray-50 p-3 rounded">
                                        <span class="block text-gray-500">Th∆∞·ªùng mua</span>
                                        <span class="font-semibold text-gray-800">${
                                          segment.buy
                                        }</span>
                                    </div>
                                    <div class="bg-gray-50 p-3 rounded">
                                        <span class="block text-gray-500">Th·ªùi gian Hƒê</span>
                                        <span class="font-semibold text-gray-800">${
                                          segment.activity
                                        }</span>
                                    </div>
                                </div>
                                
                                <div>
                                    <h4 class="font-semibold text-gray-700">${
                                      segment.behavior_title
                                    }</h4>
                                    <div class="text-sm text-gray-600 mt-1 space-y-1">${
                                      segment.behavior_desc
                                    }</div>
                                </div>
                            </div>
                            <div class="bg-gray-100 p-4 border-t border-gray-200 ${
                              segment.geo === "N/A" ? "hidden" : ""
                            }">
                               <span class="text-xs font-medium text-gray-500">Ph√¢n b·ªë ƒê·ªãa l√Ω (M√¥ ph·ªèng): ${
                                 segment.geo
                               }</span>
                               <div class="w-full bg-gray-200 rounded h-2.5 mt-1.5 flex">
                                   </div>
                            </div>
                        </div>
                    `;
          });

          this.ui.segmentCardsContainer.innerHTML = html;
        }

        // X·ª≠ l√Ω ch·ªçn B∆∞·ªõc 3 (Ch·ªâ d√†nh cho K√äNH OWNED)
        selectSegment(segmentId, segmentName) {
          this.state.selectedSegment = { id: segmentId, name: segmentName };
          this.ui.selectedSegmentText.textContent = segmentName;

          // H√†m n√†y gi·ªù ch·ªâ ƒë∆∞·ª£c g·ªçi b·ªüi lu·ªìng Owned
          this.renderStep4_Owned();
          this.showStep(4);
        }

        // *** B∆Ø·ªöC 4: Render chi·∫øn thu·∫≠t (CHO K√äNH OWNED) ***
        renderStep4_Owned() {
          const segmentId = this.state.selectedSegment.id;
          const tactics = this.data.mockDataOwned.tactics[segmentId];
          const recommendations =
            this.data.mockDataOwned.tacticRecommendations[segmentId] || [];

          // ·∫®n/hi·ªán c·ªôt
          this.ui.marketplaceChannels.style.display = "none";
          this.ui.ownedChannels.style.display = "block";
          this.ui.step4Grid.classList.remove("lg:grid-cols-2");

          let ownedHtml = "";
          if (tactics && tactics.owned && tactics.owned.length > 0) {
            tactics.owned.forEach((tactic) => {
              const isRecommended = recommendations.includes(tactic.id);
              // (HTML Render y h·ªát code g·ªëc)
              const cardClasses =
                "border-blue-600 border-2 shadow-lg scale-[1.03]";
              const buttonClasses = "bg-blue-600 text-white hover:bg-blue-700";
              const badge =
                '<span class="absolute top-0 right-0 -mt-2.5 -mr-2.5 bg-blue-600 text-white text-xs font-bold px-2 py-0.5 rounded-full z-10">ƒê·ªÄ XU·∫§T</span>';

              ownedHtml += `
                            <div class="relative bg-white p-4 rounded-lg border border-gray-300 shadow-sm transition-all ${cardClasses}">
                                ${badge}
                                <h4 class="font-semibold text-gray-800">${
                                  tactic.name
                                }</h4>
                                <p class="text-sm text-gray-500 mb-3">${
                                  tactic.desc
                                }</p>
                                <button class="w-full text-center px-3 py-1.5 rounded-md font-medium text-sm transition-colors ${buttonClasses}"
                                        onclick='app.selectTactic(${JSON.stringify(
                                          tactic.id
                                        )}, ${JSON.stringify(
                tactic.name
              )}, "owned")'>
                                    Thi·∫øt K·∫ø Chi·∫øn D·ªãch
                                </button>
                            </div>
                        `;
            });
          } else {
            ownedHtml =
              '<p class="text-gray-500 text-sm">Kh√¥ng c√≥ chi·∫øn thu·∫≠t "Owned" n√†o ƒë∆∞·ª£c ƒë·ªÅ xu·∫•t c·ª• th·ªÉ cho ph√¢n kh√∫c n√†y.</p>';
          }
          this.ui.ownedTacticsList.innerHTML = ownedHtml;
          this.ui.marketplaceTacticsList.innerHTML = ""; // X√≥a c·ªôt MP
        }

        // *** B∆Ø·ªöC 4 (M·ªöI): Render chi·∫øn thu·∫≠t (CHO MARKETPLACE) ***
        renderStep4_Marketplace() {
          // 1. L·∫•y m·ª•c ti√™u ƒë√£ ch·ªçn
          const goalId = this.state.selectedObjective.id;

          // 2. L·∫•y T·∫§T C·∫¢ chi·∫øn thu·∫≠t c·ªßa Marketplace
          const allTactics = this.data.mockDataMarketplace.tactics.marketplace;

          // 3. L·∫•y d·ªØ li·ªáu ph√¢n b·ªï
          const distribution =
            this.data.mockDataMarketplace.segmentDistribution;
          const distributionMap = distribution.reduce((acc, seg) => {
            acc[seg.id] = seg.percentage;
            return acc;
          }, {});

          // 4. *** LOGIC NGHI·ªÜP V·ª§ M·ªöI ***
          // (Goal) + (Segment Distribution) -> Recommendations
          let recommendations = [];
          let logicName = "ƒê·ªÅ xu·∫•t chung";

          // K·ªãch b·∫£n 1: T·ªáp "Gi√†u c√≥" (VIP + Loyal > 40%)
          const richPercentage =
            (distributionMap["mp_vip"] || 0) +
            (distributionMap["mp_loyal"] || 0);
          // K·ªãch b·∫£n 2: T·ªáp "Ng·ªß qu√™n" (Nguy c∆° > 35%)
          const atRiskPercentage = distributionMap["mp_at_risk"] || 0;
          // K·ªãch b·∫£n 3: T·ªáp "M·ªõi" (M·ªõi + M·∫•t > 40% ho·∫∑c M·ªõi > 20%)
          const newPercentage =
            (distributionMap["mp_new"] || 0) +
            (distributionMap["mp_lost"] || 0);
          const onlyNewPercentage = distributionMap["mp_new"] || 0;

          if (goalId === "revenue" && richPercentage > 40) {
            // K·ªãch b·∫£n 1: T·ªëi ∆∞u doanh thu t·ªáp "Gi√†u c√≥"
            recommendations = ["mp_voucher", "mp_combo", "mp_livestream"];
            logicName = `T·ªáp VIP/Trung th√†nh (${richPercentage}%)`;
          } else if (goalId === "awareness" && atRiskPercentage > 35) {
            // K·ªãch b·∫£n 2: K√≠ch ho·∫°t t·ªáp "Ng·ªß qu√™n"
            recommendations = ["mp_flash_sale", "mp_livestream", "mp_voucher"];
            logicName = `T·ªáp Nguy c∆° (${atRiskPercentage}%)`;
          } else if (
            goalId === "conversion" &&
            (newPercentage > 40 || onlyNewPercentage > 20)
          ) {
            // K·ªãch b·∫£n 3: Chuy·ªÉn ƒë·ªïi t·ªáp "M·ªõi"
            recommendations = ["mp_ads", "mp_voucher", "mp_combo"];
            logicName = `T·ªáp M·ªõi/V√£ng lai (${onlyNewPercentage}%)`;
          } else if (goalId === "launch") {
            // K·ªãch b·∫£n 4: Ra m·∫Øt SP
            recommendations = ["mp_livestream", "mp_ads", "mp_voucher"];
            logicName = "Ra m·∫Øt S·∫£n ph·∫©m M·ªõi";
          } else {
            // Logic d·ª± ph√≤ng: ƒê·ªÅ xu·∫•t m·∫∑c ƒë·ªãnh d·ª±a tr√™n m·ª•c ti√™u
            if (goalId === "revenue")
              recommendations = ["mp_combo", "mp_voucher"];
            else if (goalId === "conversion")
              recommendations = ["mp_ads", "mp_voucher"];
            else if (goalId === "awareness")
              recommendations = ["mp_flash_sale", "mp_livestream"];
            else if (goalId === "launch")
              recommendations = ["mp_livestream", "mp_ads", "mp_voucher"];
            logicName = "ƒê·ªÅ xu·∫•t chung theo M·ª•c ti√™u";
          }

          // G√°n 1 segment ·∫£o ƒë·ªÉ hi·ªÉn th·ªã ·ªü B∆∞·ªõc 5
          this.state.selectedSegment = {
            id: "marketplace_logic",
            name: `Logic: ${logicName}`,
          };
          this.ui.selectedSegmentText.textContent = `Logic: ${logicName}`;

          // 5. ·∫®n/hi·ªán c·ªôt
          this.ui.ownedChannels.style.display = "none";
          this.ui.marketplaceChannels.style.display = "block";
          this.ui.step4Grid.classList.remove("lg:grid-cols-2");

          // 6. Render HTML
          let mpHtml = "";
          allTactics.forEach((tactic) => {
            const isRecommended = recommendations.includes(tactic.id);

            const cardClasses = isRecommended
              ? "border-blue-600 border-2 shadow-lg scale-[1.03]"
              : "opacity-70 hover:opacity-100";
            const buttonClasses = isRecommended
              ? "bg-blue-600 text-white hover:bg-blue-700"
              : "bg-blue-100 text-blue-700 hover:bg-blue-200";
            const badge = isRecommended
              ? '<span class="absolute top-0 right-0 -mt-2.5 -mr-2.5 bg-blue-600 text-white text-xs font-bold px-2 py-0.5 rounded-full z-10">ƒê·ªÄ XU·∫§T</span>'
              : "";

            mpHtml += `
                        <div class="relative bg-white p-4 rounded-lg border border-gray-300 shadow-sm transition-all ${cardClasses}">
                            ${badge}
                            <h4 class="font-semibold text-gray-800">${
                              tactic.name
                            }</h4>
                            <p class="text-sm text-gray-500 mb-3">${
                              tactic.desc
                            }</p>
                            <button class="w-full text-center px-3 py-1.5 rounded-md font-medium text-sm transition-colors ${buttonClasses}"
                                    onclick='app.selectTactic(${JSON.stringify(
                                      tactic.id
                                    )}, ${JSON.stringify(
              tactic.name
            )}, "marketplace")'>
                                Thi·∫øt K·∫ø Chi·∫øn D·ªãch
                            </button>
                        </div>
                    `;
          });
          this.ui.marketplaceTacticsList.innerHTML = mpHtml;
          this.ui.ownedTacticsList.innerHTML = ""; // X√≥a c·ªôt Owned
        }

        // X·ª≠ l√Ω ch·ªçn B∆∞·ªõc 4 (*** KH√îNG C·∫¶N THAY ƒê·ªîI ***)
        selectTactic(tacticId, tacticName, tacticType) {
          this.state.selectedTactic = {
            id: tacticId,
            name: tacticName,
            type: tacticType,
          };
          this.renderStep5();
          this.showStep(5);
        }

        // *** B∆Ø·ªöC 5: Render form thi·∫øt k·∫ø ***
        renderStep5() {
          // (Gi·ªØ nguy√™n)
          this.ui.campaignBuilderForm.reset();

          // ƒêi·ªÅn th√¥ng tin t·ª± ƒë·ªông
          this.ui.campaignSegmentInput.value = this.state.selectedSegment.name;
          this.ui.campaignNameInput.value = `[${this.state.selectedTactic.name}] - ${this.state.selectedObjective.title}`;

          // Hi·ªÉn th·ªã ti√™u ƒë·ªÅ c·∫•u h√¨nh
          this.ui.dynamicTacticTitle.textContent = `C·∫•u h√¨nh chi ti·∫øt: ${this.state.selectedTactic.name}`;

          // Ch√®n form ƒë·ªông
          let formHtml = "";
          if (this.state.selectedTactic.type === "marketplace") {
            formHtml =
              this.data.marketplaceFormSnippets[this.state.selectedTactic.id] ||
              '<p class="text-gray-500">Kh√¥ng c√≥ c·∫•u h√¨nh chi ti·∫øt cho chi·∫øn thu·∫≠t n√†y.</p>';
          } else {
            // Form ƒë·ªông cho K√™nh S·ªü H·ªØu
            formHtml = `
                        <p class="text-sm text-gray-600 mb-4">C·∫•u h√¨nh cho chi·∫øn d·ªãch K√™nh S·ªü H·ªØu.</p>
                        <div class="space-y-4">
                            <div>
                                <label for="tactic-owned-channels" class="block text-sm font-medium text-gray-700">K√™nh ch·∫°y (ch·ªçn nhi·ªÅu)</label>
                                <div class="mt-2 space-x-4">
                                    <label class="inline-flex items-center"><input type="checkbox" class="rounded border-gray-300 text-blue-600 shadow-sm focus:ring-blue-500" checked> <span class="ml-2">Email</span></label>
                                    <label class="inline-flex items-center"><input type="checkbox" class="rounded border-gray-300 text-blue-600 shadow-sm focus:ring-blue-500"> <span class="ml-2">Zalo OA</span></label>
                                </div>
                            </div>
                            <div>
                                <label for="tactic-owned-content" class="block text-sm font-medium text-gray-700">B√†i Vi·∫øt / Link N·ªôi Dung</label>
                                <input type="text" id="tactic-owned-content" placeholder="https://mywebsite.com/landing-page" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500">
                            </div>
                            <div>
                                <label for="tactic-owned-message" class="block text-sm font-medium text-gray-700">N·ªôi Dung Ch·∫°y (Th√¥ng ƒëi·ªáp/Voucher)</label>
                                <textarea id="tactic-owned-message" rows="2" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500" placeholder="S·ª≠ d·ª•ng m√£ VIP10 ƒë·ªÉ gi·∫£m 10%..."></textarea>
                            </div>
                        </div>
                    `;
          }
          this.ui.dynamicTacticFormFields.innerHTML = formHtml;
        }

        // X·ª≠ l√Ω l∆∞u chi·∫øn d·ªãch (B∆∞·ªõc 5)
        handleSaveCampaign(e) {
          // (Gi·ªØ nguy√™n)
          e.preventDefault();

          let dynamicData = {};
          const dynamicInputs =
            this.ui.dynamicTacticFormFields.querySelectorAll(
              "input, select, textarea"
            );
          dynamicInputs.forEach((input) => {
            dynamicData[input.id] = input.value;
          });

          const newCampaign = {
            id: Date.now(),
            name: this.ui.campaignNameInput.value,
            platform: this.state.selectedPlatform,
            objective: this.state.selectedObjective.title,
            segment: this.state.selectedSegment.name,
            tactic: this.state.selectedTactic.name,
            status: "üìù ƒê√£ l∆∞u",
            budget: parseFloat(this.ui.campaignBudetInput.value) || 0,
            revenue: 0,
            kpi: this.ui.campaignKpiInput.value,
            startDate: this.ui.campaignStartDateInput.value,
            endDate: this.ui.campaignEndDateInput.value,
            notes: this.ui.campaignNotesInput.value,
            dynamicData: dynamicData,
          };

          this.state.campaigns.push(newCampaign);
          this.ui.navDashboard.textContent = `Xem Dashboard (${this.state.campaigns.length})`;
          this.showStep(6);
          this.navigateTo("dashboard");
        }

        // --- B∆Ø·ªöC 6 (DASHBOARD) ---

        renderDashboard() {
          // (Gi·ªØ nguy√™n)
          if (this.state.campaigns.length === 0) {
            this.ui.campaignTableBody.innerHTML = `<tr><td colspan="7" class="px-6 py-10 text-center text-gray-500">Ch∆∞a c√≥ chi·∫øn d·ªãch n√†o.</td></tr>`;
            return;
          }

          let html = "";
          this.state.campaigns.forEach((campaign, index) => {
            const budget = campaign.budget;
            const revenue = campaign.revenue;
            let roi = "N/A";
            if (budget > 0) {
              roi = `${(((revenue - budget) / budget) * 100).toFixed(0)}%`;
            } else if (revenue > 0) {
              roi = "‚àû";
            }
            const roiClass =
              budget > 0
                ? revenue > budget
                  ? "text-green-600"
                  : "text-red-600"
                : "text-gray-600";

            let actionButton = "";
            if (campaign.status === "üìù ƒê√£ l∆∞u") {
              actionButton = `<button onclick="app.activateCampaign(${index})" class="text-green-600 hover:text-green-900 font-medium">K√≠ch ho·∫°t</button>`;
            } else if (campaign.status === "üü¢ ƒêang ch·∫°y") {
              actionButton = `<button onclick="app.showResultModal(${index})" class="text-blue-600 hover:text-blue-900 font-medium">Nh·∫≠p K·∫øt Qu·∫£</button>`;
            } else if (campaign.status === "üü° ƒê√£ k·∫øt th√∫c") {
              actionButton = `<button onclick="app.showResultModal(${index})" class="text-gray-600 hover:text-gray-900 font-medium">Xem/S·ª≠a KQ</button>`;
            }

            html += `
                        <tr class="hover:bg-gray-50">
                            <td class="px-6 py-4 whitespace-nowrap">
                                <div class="text-sm font-medium text-gray-900">${
                                  campaign.name
                                }</div>
                                <div class="text-sm text-gray-500">${
                                  campaign.tactic
                                }</div>
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-600">${
                              campaign.segment
                            }</td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-600">${this.formatCurrency(
                              budget
                            )}</td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-600">${this.formatCurrency(
                              revenue
                            )}</td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm font-bold ${roiClass}">${roi}</td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm font-medium space-x-2">
                                ${actionButton}
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap">
                                <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${
                                  campaign.status.includes("ƒêang ch·∫°y")
                                    ? "bg-green-100 text-green-800"
                                    : campaign.status.includes("ƒê√£ k·∫øt th√∫c")
                                    ? "bg-yellow-100 text-yellow-800"
                                    : campaign.status.includes("ƒê√£ l∆∞u")
                                    ? "bg-gray-100 text-gray-800"
                                    : "bg-red-100 text-red-800"
                                }">
                                    ${campaign.status}
                                </span>
                            </td>
                        </tr>
                    `;
          });
          this.ui.campaignTableBody.innerHTML = html;
        }

        // --- QU·∫¢N L√ù MODAL ---

        openModal(modalId) {
          // (Gi·ªØ nguy√™n)
          document.getElementById(modalId).classList.add("flex");
        }

        closeModal(modalId) {
          // (Gi·ªØ nguy√™n)
          document.getElementById(modalId).classList.remove("flex");
        }

        // Hi·ªÉn th·ªã modal Demo
        showDemoModal() {
          // (Gi√É·ªØ nguy√™n)
          const platformText =
            this.state.selectedPlatform === "owned"
              ? "K√™nh S·ªü H·ªØu"
              : "K√™nh S√†n TMƒêT";
          this.ui.demoPlatform.textContent = platformText;

          this.ui.demoGoal.textContent = this.state.selectedObjective.title;
          this.ui.demoSegment.textContent = this.state.selectedSegment.name;
          this.ui.demoTactic.textContent = this.state.selectedTactic.name;
          this.ui.demoBudget.textContent = this.formatCurrency(
            this.ui.campaignBudetInput.value || 0
          );
          this.ui.demoDuration.textContent = `${
            this.ui.campaignStartDateInput.value || "N/A"
          } - ${this.ui.campaignEndDateInput.value || "N/A"}`;
          this.ui.demoKpi.textContent =
            this.ui.campaignKpiInput.value || "Ch∆∞a thi·∫øt l·∫≠p";

          let demoDetailsHtml =
            '<h4 class="text-base font-semibold text-gray-700 mb-2">Chi ti·∫øt C·∫•u h√¨nh</h4><ul class="list-disc pl-5 space-y-1 text-sm text-gray-600">';
          const dynamicInputs =
            this.ui.dynamicTacticFormFields.querySelectorAll(
              "input, select, textarea"
            );
          dynamicInputs.forEach((input) => {
            const label = input.previousElementSibling
              ? input.previousElementSibling.textContent
              : input.id || "Chi ti·∫øt";
            const value = input.value || "<em>(ch∆∞a nh·∫≠p)</em>";
            demoDetailsHtml += `<li><strong>${label}:</strong> ${value}</li>`;
          });
          demoDetailsHtml += "</ul>";
          this.ui.demoDynamicDetails.innerHTML = demoDetailsHtml;

          this.openModal("demoModal");
        }

        // Hi·ªÉn th·ªã modal Nh·∫≠p K·∫øt Qu·∫£
        showResultModal(index) {
          // (Gi·ªØ nguy√™n)
          const campaign = this.state.campaigns[index];
          if (!campaign) return;

          this.ui.resultForm.reset();
          this.ui.resultCampaignName.textContent = campaign.name;
          this.ui.campaignIndexInput.value = index;
          this.ui.campaignRevenueInput.value =
            campaign.revenue > 0 ? campaign.revenue : "";
          this.openModal("resultModal");
        }

        // X·ª≠ l√Ω l∆∞u k·∫øt qu·∫£
        handleSaveResult(e) {
          // (Gi·ªØ nguy√™n)
          e.preventDefault();
          const index = parseInt(this.ui.campaignIndexInput.value);
          const revenue = parseFloat(this.ui.campaignRevenueInput.value);

          if (
            index >= 0 &&
            index < this.state.campaigns.length &&
            !isNaN(revenue)
          ) {
            this.state.campaigns[index].revenue = revenue;
            this.state.campaigns[index].status = "üü° ƒê√£ k·∫øt th√∫c";
            this.renderDashboard();
          }
          this.closeModal("resultModal");
        }

        // K√çCH HO·∫†T CHI·∫æN D·ªäCH
        activateCampaign(index) {
          // (Gi·ªØ nguy√™n)
          if (index >= 0 && index < this.state.campaigns.length) {
            this.state.campaigns[index].status = "üü¢ ƒêang ch·∫°y";
            this.renderDashboard();
          }
        }

        // --- H√ÄM TI·ªÜN √çCH ---
        formatCurrency(value) {
          // (Gi·ªØ nguy√™n)
          const num = parseFloat(value);
          if (isNaN(num)) return "0 VNƒê";
          return new Intl.NumberFormat("vi-VN", {
            style: "currency",
            currency: "VND",
          }).format(num);
        }
      }

      // Kh·ªüi ch·∫°y ·ª©ng d·ª•ng khi DOM ƒë√£ t·∫£i xong
      document.addEventListener("DOMContentLoaded", () => {
        // Kh·ªüi t·∫°o ƒë·ªëi t∆∞·ª£ng app ch√≠nh
        window.app = new MarketingApp(mockData);
      });
    </script>
  </body>
</html>
